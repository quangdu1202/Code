<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Document</title>
  <link rel="stylesheet" href="styles.css" />
  <script defer="defer" src="alpinejs.min.js"></script>
  <script src="scripts.js"></script>
  <style>
    .notification {
      position: fixed;
      bottom: 10px;
      right: 10px;
      padding: 15px;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      color: #fff;
    }

    .notification.info {
      background-color: #2196f3;
    }

    .notification.success {
      background-color: #4caf50;
    }

    .notification.warning {
      background-color: #ff9800;
    }

    .notification.error {
      background-color: #f44336;
    }
  </style>
</head>

<body class="flex justify-center items-center">
  <div x-data="initSankakuTools()" x-init="init()"
    class="flex w-full flex-col items-center justify-center rounded-lg border bg-white p-8 shadow-lg">
    <div class="fixed inset-0 z-50 flex h-full w-full items-center justify-center bg-gray-800 bg-opacity-50"
      x-show="isLoading" x-cloak x-transition:enter="ease-out duration-200" x-transition:enter-start="opacity-0"
      x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
      x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
      <svg class="h-16 w-16 animate-spin text-green-800" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
        <circle class="opacity-25" cx="25" cy="25" r="20" stroke="currentColor" stroke-width="4" fill="none"></circle>
        <path class="opacity-75" fill="currentColor" d="M25 5A20 20 0 0 1 45 25h-5a15 15 0 0 0-15-15V5z"></path>
      </svg>
    </div>
    <template x-if="!token.hasToken">
      <form @submit.prevent="getToken" class="max-w-screen-lg">
        <h2 class="mb-4 text-center text-2xl font-bold text-red">Missing tokens, login first</h2>
        <div class="mb-4">
          <label class="mb-2 block font-bold text-gray-700" for="username">Username</label>
          <input type="text" id="username" name="login" required x-model="loginData.login"
            placeholder="Enter your username"
            class="w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
        </div>
        <div class="mb-4">
          <label class="mb-2 block font-bold text-gray-700" for="password">Password</label>
          <input type="password" id="password" name="password" required x-model="loginData.password"
            placeholder="Enter your password"
            class="w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
        </div>
        <div class="flex justify-center">
          <button type="submit"
            class="rounded-lg bg-blue-500 px-4 py-2 font-bold text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            Login
          </button>
        </div>
      </form>
    </template>
    <template x-if="token.hasToken">
      <div class="w-full grid grid-cols-2">
        <div class="w-full col-span-2 hidden">
          <div class="my-2"><strong>Token Type: </strong><span x-text="token.type"></span></div>
          <div class="my-2">
            <strong>Token:</strong>
            <button @click="copyToken"
              class="mx-2 rounded bg-green-100 text-sm font-semibold text-green-800 px-2.5 py-0.5 hover:bg-green-300">
              Copy
            </button>
            <small x-ref="token" x-show="false" x-text="token.access_token" class="break-words"></small><span>expire at
              <span x-text="token.expiry_date"></span></span>
          </div>
          <div class="my-2">
            <strong>Refresh Token:</strong>
            <button @click="copyRefreshToken"
              class="rounded bg-green-100 text-sm font-semibold text-green-800 me-2 px-2.5 py-0.5 hover:bg-green-300">
              Copy
            </button>
            <small x-ref="refreshToken" x-show="false" x-text="token.refresh_token"
              class="break-words"></small><span>expire
              at <span x-text="token.refresh_expiry_date"></span></span>
          </div>
        </div>

        <div class="w-full">
          <form @submit.prevent="processFile" class="mt-4">
            <div class="mb-4">
              <label class="mb-2 block font-bold text-gray-700" for="file">Select a file</label>
              <input type="file" id="file" @change="handleFileUpload"
                class="w-full rounded-lg border px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>
            <div class="flex justify-center gap-4">
              <button type="submit"
                class="rounded-lg bg-green-500 px-4 py-2 font-bold text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500">
                Process File
              </button>
              <button type="button" @click="downloadTagsJson()"
                class="rounded-lg bg-blue-500 px-4 py-2 font-bold text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                JSON Content
              </button>
              <button type="button" @click="directDownloadTagsJson()"
                class="rounded-lg bg-blue-500 px-4 py-2 font-bold text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                Direct Download JSON
              </button>
            </div>
          </form>
          <template x-if="tags.length > 0">
            <div class="my-8">
              <div class="mb-4 flex flex-col md:space-x-4 md:flex-row md:items-center">
                <div class="mb-4 flex flex-col md:mb-0">
                  <label for="followFilter" class="font-semibold">Following Status:</label>
                  <select @change="filterTags()" id="followFilter" x-model="selectedFollowFilter"
                    class="mt-1 rounded border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                    <option value="all">All</option>
                    <option value="1">Following</option>
                    <option value="0">Error / Not Following</option>
                  </select>
                </div>
                <div class="flex flex-col">
                  <label for="statusFilter" class="font-semibold">Fetch Status:</label>
                  <select @change="filterTags()" id="statusFilter" x-model="selectedFetchFilter"
                    class="mt-1 rounded border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                    <option value="all">All</option>
                    <option value="1">Fetched</option>
                    <option value="0">Error / Unfetched</option>
                  </select>
                </div>
                <div class="flex flex-col relative">
                  <label for="searchTag" class="font-semibold">Search:</label>
                  <input type="text" id="searchTag" class="text-sm border rounded p-1 mr-2"
                    @input.debounce="searchTagSuggestionsFetched = false; console.log('changed')"
                    @input.debounce.1000="getTagSearchSuggestions($el)"
                    @focus.debounce.500="getTagSearchSuggestions($el)">
                </div>
              </div>
              <div id="fileData" class="mt-4" style="max-height: 600px; overflow-y: scroll; border: 1px solid #000;">
                <table class="min-w-full table-fixed border border-gray-300 divide-y divide-gray-200">
                  <thead>
                    <tr class="text-center text-sm font-semibold uppercase tracking-wider text-gray-500">
                      <th class="sticky top-0 w-24 bg-gray-200 px-4 py-2">No.</th>
                      <th class="sticky top-0 w-36 bg-gray-200 px-4 py-2">ID</th>
                      <th class="sticky top-0 bg-gray-200 px-4 py-2">
                        <span @click="sortTags('name')" class="cursor-pointer">
                          Name
                          <span x-show="sortBy === 'name'">
                            <template x-if="sortDesc"><span>▼</span></template>
                            <template x-if="!sortDesc"><span>▲</span></template>
                          </span>
                        </span>
                      </th>
                      <th class="top-0 bg-gray-200 px-4 py-2 w-48	sticky">
                        <span @click="sortTags('following')" class="block cursor-pointer text-center">
                          Following
                          <span x-show="sortBy === 'following'">
                            <template x-if="sortDesc"><span>▼</span></template>
                            <template x-if="!sortDesc"><span>▲</span></template>
                          </span>
                        </span>
                        <div class="flex justify-center gap-2">
                          <button @click="fetchFollowingTags()"
                            class="rounded bg-blue-500 px-2 py-1 text-xs text-white hover:bg-blue-700">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12"
                              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round">
                              <polyline points="1 4 1 10 7 10" />
                              <polyline points="23 20 23 14 17 14" />
                              <path d="M20.49 9A9 9 0 0 0 6.6 5.2L1 10" />
                              <path d="M3.51 15A9 9 0 0 0 17.4 18.8L23 14" />
                            </svg>
                          </button>
                          <button @click="unFollowSelectedTags()"
                            class="rounded bg-red-500 px-2 py-1 text-xs text-white hover:bg-red-700">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12"
                              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round">
                              <line x1="18" y1="6" x2="6" y2="18" />
                              <line x1="6" y1="6" x2="18" y2="18" />
                            </svg>
                          </button>
                          <button @click="followSelectedTags()"
                            class="rounded bg-green-500 px-2 py-1 text-xs text-white hover:bg-green-700">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12"
                              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round">
                              <polyline points="20 6 9 17 4 12" />
                            </svg>
                          </button>
                        </div>
                      </th>
                      <th class="sticky top-0 w-16 bg-gray-200 px-4 py-2">
                        <button @click="selectAll()" class="flex w-full items-center justify-center">
                          <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="30px" viewBox="0 0 24 30"
                            fill="none" x="0px" y="0px">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                              d="M4 1C2.34315 1 1 2.34315 1 4V20C1 21.6569 2.34315 23 4 23H20C21.6569 23 23 21.6569 23 20V4C23 2.34315 21.6569 1 20 1H4ZM3 4C3 3.44772 3 3 4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4Z"
                              fill="black" />
                            <path x-show="selectedAll"
                              d="M18.7071 8.70711C19.0976 8.31658 19.0976 7.68342 18.7071 7.29289C18.3166 6.90237 17.6834 6.90237 17.2929 7.29289L10 14.5858L6.70711 11.2929C6.31658 10.9024 5.68342 10.9024 5.29289 11.2929C4.90237 11.6834 4.90237 12.3166 5.29289 12.7071L9.29289 16.7071C9.68342 17.0976 10.3166 17.0976 10.7071 16.7071L18.7071 8.70711Z"
                              fill="black" />
                          </svg>
                        </button>
                      </th>
                    </tr>
                  </thead>
                  <tbody class="bg-white divide-y divide-gray-200">
                    <template x-for="(tag, index) in filteredTags" :key="index">
                      <tr :class="index % 2 === 1 ? 'bg-gray-50' : ''">
                        <td class="px-4 py-2 text-center text-sm text-gray-900" x-text="index + 1"
                          :class="tag.fetched === true ? 'text-green-700' : (tag.fetched === null ? 'text-red-700' : '')">
                        </td>
                        <td class="px-4 py-2 text-center text-sm text-gray-900" x-text="tag.id ?? 'null'"
                          :class="tag.fetched === true ? 'text-green-700' : (tag.fetched === null ? 'text-red-700' : '')">
                        </td>
                        <td class="group px-4 py-2 text-sm text-gray-900 overflow-visible" @mouseleave="hideTagsUrl()">
                          <div class="flex justify-between items-center relative">
                            <div class="flex items-center grow">
                              <svg
                                class="mr-4 invisible cursor-pointer opacity-80 hover:opacity-100 group-hover:visible"
                                @click="removeTag(tag)" xmlns="http://www.w3.org/2000/svg" width="20px" height="20px"
                                viewBox="0 0 1024 1024">
                                <path
                                  d="M779.5 1002.7h-535c-64.3 0-116.5-52.3-116.5-116.5V170.7h768v715.5c0 64.2-52.3 116.5-116.5 116.5zM213.3 256v630.1c0 17.2 14 31.2 31.2 31.2h534.9c17.2 0 31.2-14 31.2-31.2V256H213.3z"
                                  fill="#f51818" />
                                <path
                                  d="M917.3 256H106.7C83.1 256 64 236.9 64 213.3s19.1-42.7 42.7-42.7h810.7c23.6 0 42.7 19.1 42.7 42.7S940.9 256 917.3 256zM618.7 128H405.3c-23.6 0-42.7-19.1-42.7-42.7s19.1-42.7 42.7-42.7h213.3c23.6 0 42.7 19.1 42.7 42.7S642.2 128 618.7 128zM405.3 725.3c-23.6 0-42.7-19.1-42.7-42.7v-256c0-23.6 19.1-42.7 42.7-42.7S448 403 448 426.6v256c0 23.6-19.1 42.7-42.7 42.7zM618.7 725.3c-23.6 0-42.7-19.1-42.7-42.7v-256c0-23.6 19.1-42.7 42.7-42.7s42.7 19.1 42.7 42.7v256c-0.1 23.6-19.2 42.7-42.7 42.7z"
                                  fill="#5F6379" />
                              </svg>
                              <!-- Display the tag as a link if fetched is true and not in edit mode -->
                              <a x-show="!tag.isEditing && tag.fetched === true" :title="tag.tagName"
                                :href="getTagPostsUrl(tag)" target="_blank" class="mr-2 text-blue-600 hover:underline"
                                x-text="tag.tagName"></a>
                              <!-- Display the tag name as plain text if fetched is false and not in edit mode -->
                              <span x-show="!tag.isEditing && tag.fetched !== true" :title="tag.tagName"
                                x-text="tag.tagName" class="mr-2"></span>

                              <!-- Input field for editing the tag name, shown regardless of fetched status when in edit mode-->
                              <input type="text" class="text-sm border rounded p-1 mr-2" x-show="tag.isEditing"
                                x-model="tag.tagName" @keydown.enter="tag.isEditing = false"
                                @click.away="delete tag.isEditing"
                                @input.debounce="searchTagSuggestionsFetched = false; console.log('changed')"
                                @input.debounce.1000="getTagSearchSuggestions($el)"
                                @focus.debounce.500="getTagSearchSuggestions($el)">

                              <!-- Toggle edit mode-->
                              <button class="invisible ml-1 opacity-80 hover:opacity-100 group-hover:visible">
                                <!--Edit icon-->
                                <svg x-show="!tag.isEditing" @click="tag.isEditing = true" width="18px" height="18px"
                                  class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
                                  <title x-text="`Edit tag name`"></title>
                                  <path fill="#3688FF"
                                    d="M823 939H229c-71 0-129-58-129-130V215c0-71 58-130 129-130h297a43 43 0 1 1 0 86H229c-24 0-44 20-44 44v594c0 25 20 44 44 44h594c25 0 45-20 45-44V512a43 43 0 1 1 85 0v297c0 72-58 130-130 130z" />
                                  <path fill="#5F6379"
                                    d="m483 757-5-1-135-17c-19-2-34-17-37-37l-17-134c-1-13 3-26 13-36l374-374c51-51 134-51 186 0l26 26c25 25 38 58 38 93s-13 68-38 93L513 744c-8 8-19 13-30 13zm-96-98 80 10 360-360a45 45 0 0 0 0-65l-26-26a46 46 0 0 0-65 0L377 578l10 81z" />
                                </svg>

                                <!--Confirm icon-->
                                <svg x-show="tag.isEditing" @click="delete tag.isEditing" width="18px" height="18px"
                                  fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                  xmlns="http://www.w3.org/2000/svg">
                                  <title x-text="`Tag name has changed`"></title>
                                  <path id="Vector" d="M6 12L10.2426 16.2426L18.727 7.75732" stroke="#000000"
                                    stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                              </button>
                            </div>
                            <div x-show="tag.fetched" class="flex items-center gap-2">
                              <span class="text-gray-500 italic" x-text="formatPostCount(tag.post_count)"></span>
                              <button @mouseover="showTagsUrl(tag, $el)">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24"
                                  fill="none">
                                  <path id="Vector"
                                    d="M10.0002 5H8.2002C7.08009 5 6.51962 5 6.0918 5.21799C5.71547 5.40973 5.40973 5.71547 5.21799 6.0918C5 6.51962 5 7.08009 5 8.2002V15.8002C5 16.9203 5 17.4801 5.21799 17.9079C5.40973 18.2842 5.71547 18.5905 6.0918 18.7822C6.5192 19 7.07899 19 8.19691 19H15.8031C16.921 19 17.48 19 17.9074 18.7822C18.2837 18.5905 18.5905 18.2839 18.7822 17.9076C19 17.4802 19 16.921 19 15.8031V14M20 9V4M20 4H15M20 4L13 11"
                                    stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                              </button>
                            </div>
                          </div>
                        </td>
                        <td class="px-4 py-2 text-center text-sm text-gray-900">
                          <template x-if="tag.fetched !== true">
                            <button disabled="disabled" class="rounded bg-gray-500 px-4 py-1 text-white">-
                            </button>
                          </template>
                          <template x-if="tag.fetched === true && tag.following === false">
                            <button @click="followTag(tag)"
                              class="rounded bg-green-500 px-4 py-1 text-white hover:bg-green-700">
                              Follow
                            </button>
                          </template>
                          <template x-if="tag.fetched === true && tag.following === true">
                            <button @click="unfollowTag(tag)"
                              class="rounded bg-red-500 px-4 py-1 text-white hover:bg-red-700">
                              Unfollow
                            </button>
                          </template>
                        </td>
                        <td class="px-4 py-2 text-center text-sm text-gray-900">
                          <button @click="selectTag(tag)" class="flex w-full items-center justify-center"
                            :disabled="tag.fetched !== true">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="30px" viewBox="0 0 24 30"
                              fill="none" x="0px" y="0px">
                              <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M4 1C2.34315 1 1 2.34315 1 4V20C1 21.6569 2.34315 23 4 23H20C21.6569 23 23 21.6569 23 20V4C23 2.34315 21.6569 1 20 1H4ZM3 4C3 3.44772 3 3 4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4Z"
                                fill="black" />
                              <path x-show="tag.selected"
                                d="M18.7071 8.70711C19.0976 8.31658 19.0976 7.68342 18.7071 7.29289C18.3166 6.90237 17.6834 6.90237 17.2929 7.29289L10 14.5858L6.70711 11.2929C6.31658 10.9024 5.68342 10.9024 5.29289 11.2929C4.90237 11.6834 4.90237 12.3166 5.29289 12.7071L9.29289 16.7071C9.68342 17.0976 10.3166 17.0976 10.7071 16.7071L18.7071 8.70711Z"
                                fill="black" />
                            </svg>
                          </button>
                        </td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
            </div>
          </template>
          <template x-if="tags.length === 0">
            <p>No file data available</p>
          </template>
          <template x-if="recentlyUnfollowedTags.length > 0">
            <div class="mt-8">
              <div class="my-4 flex items-center gap-4">
                <span class="font-bold">Recently Unfollowed Tags</span>
                <button type="button"
                  @click="if(confirm('Are you sure?')) {recentlyUnfollowedTags = []; updateLocalStorageForTags()}"
                  class="rounded-lg bg-blue-500 px-2 py-1 font-bold text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                  Clear
                </button>
              </div>
              <table class="w-full table-fixed border-collapse border border-gray-400">
                <thead>
                  <tr class="bg-gray-200">
                    <th class="sticky -top-px border border-gray-400 bg-gray-200 px-4 py-2">No.</th>
                    <th class="sticky -top-px border border-gray-400 bg-gray-200 px-4 py-2">ID</th>
                    <th class="w-3/4 sticky -top-px border border-gray-400 bg-gray-200 px-4 py-2">
                      <span @click="sortTags('name')" class="block cursor-pointer">
                        Name
                        <span x-show="sortBy === 'name'">
                          <template x-if="sortDesc"><span>▼</span></template>
                          <template x-if="!sortDesc"><span>▲</span></template>
                        </span>
                      </span>
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <template x-for="(tag, index) in recentlyUnfollowedTags" :key="index">
                    <tr>
                      <td class="border border-gray-400 px-4 py-2 text-center" x-text="index + 1"
                        :class="tag.fetched === true ? 'text-green-700' : (tag.fetched === null ? 'text-red-700' : '')">
                      </td>
                      <td class="border border-gray-400 px-4 py-2 text-center" x-text="tag.id ?? 'null'"
                        :class="(tag.fetched === true ? 'text-green-700' : (tag.fetched === null ? 'text-red-700' : ''))">
                      </td>
                      <td :title="tag.tagName" class="truncate border border-gray-400 px-4 py-2">
                        <template x-if="tag.fetched === true"><a :href="getTagPostsUrl(tag)" target="_blank"
                            class="text-blue-600 hover:underline" x-text="tag.tagName"></a></template>
                        <template x-if="tag.fetched !== true"><span x-text="tag.tagName"></span></template>
                      </td>
                    </tr>
                  </template>
                </tbody>
              </table>
            </div>
          </template>
        </div>
        <!-- Section to show posts for selected tag -->
        <div class="w-full">
          <div>
            <h2 class="text-lg font-bold mb-4">Posts for: <span x-text="selectedTagToShowPosts.tagName"></span></h2>
            <p class="text-right text-gray-500 text-sm">Total posts fetched: <span
                x-text="selectedTagToShowPosts.fetchedPosts.length"></span></p>
          </div>

          <!-- Masonry layout for posts -->
          <div class="sm:columns-1 md:columns-2 lg:columns-3 gap-4">
            <template x-for="(post, index) in selectedTagToShowPosts.fetchedPosts" :key="post.id">
              <!-- Scale container (applies to both image and overlay) -->
              <div
                class="mb-4 relative rounded shadow-lg group overflow-hidden transform transition-transform duration-300 ease-in-out hover:scale-105">

                <!-- Image -->
                <img class="w-full h-auto object-cover rounded" :src="post.preview_url" alt="Post Preview"
                  loading="lazy" />

                <!-- Button to toggle post information -->
                <button @click="post.showInfo = !post.showInfo"
                  class="absolute top-2 right-2 bg-gray-800 text-white text-xs px-2 py-1 rounded shadow-lg group-hover:opacity-100 opacity-0 transition-opacity duration-300">
                  Info
                </button>

                <!-- Post information overlay with toggle -->
                <div x-show="post.showInfo" x-transition:enter="transition ease-out duration-500"
                  x-transition:enter-start="opacity-0 transform translate-y-4"
                  x-transition:enter-end="opacity-100 transform translate-y-0"
                  x-transition:leave="transition ease-in duration-500"
                  x-transition:leave-start="opacity-100 transform translate-y-0"
                  x-transition:leave-end="opacity-0 transform translate-y-4"
                  class="absolute bottom-0 left-0 right-0 p-2 bg-black bg-opacity-50 text-white text-xs rounded-b">
                  <p x-text="'Type: ' + post.file_type"></p>
                  <p x-text="'Rating: ' + post.rating"></p>
                  <p x-text="'Size: ' + formatFileSize(post.file_size)"></p>
                </div>
              </div>
            </template>
          </div>
        </div>
      </div>
    </template>

    <!-- Global suggestions container (only one for all rows) -->
    <div x-ref="suggestionsContainer"
      class="absolute hidden z-50 bg-white border border-gray-300 rounded mt-2 shadow-sm"
      @click.away="hideSuggestions()">
      <template x-if="searchTagSuggestions.length > 0">
        <ul>
          <template x-for="suggestion in searchTagSuggestions" :key="suggestion.id">
            <li class="flex justify-between px-4 py-2 gap-8 cursor-pointer hover:bg-gray-100"
              @click="applySuggestion(suggestion)">
              <span x-text="suggestion.name"></span>
              <div class="inline-flex justify-between items-center gap-2">
                <span class="text-xs text-gray-500" x-text="suggestion.rating ? suggestion.rating : ''"></span>
                <span class="text-xs text-gray-500" x-text="formatPostCount(suggestion.post_count)"></span>
              </div>
            </li>
          </template>
        </ul>
      </template>
      <template x-if="searchTagSuggestions.length === 0">
        <p>
          No suggestions found
        </p>
      </template>
    </div>

    <!-- Global tag urls container -->
    <div x-ref="tagUrlsContainer" @mouseleave="hideTagsUrl()"
      class="absolute grid grid-cols-2 divide-x hidden z-50 bg-white border border-gray-300 rounded mt-2 shadow-sm">
      <a x-ref="tagWikiUrlEl" href="" class="relative flex justify-between items-center px-4 py-2 hover:bg-gray-100"
        target="_blank">
        Wiki
        <svg class="float-right ml-2" xmlns="http://www.w3.org/2000/svg" width="12px" height="12px" viewBox="0 0 16 16"
          fill="none">
          <path d="M7 13V10H0L1.74846e-07 6L7 6L7 3L8 3L13 8L8 13H7Z" fill="#000000" />
          <path d="M14 14V2L16 2V14H14Z" fill="#000000" />
        </svg>
      </a>
      <button @click="fetchAllPostsOfTag(currentTag)" x-ref="tagPostsUrlEl" href=""
        class="relative flex justify-between items-center px-4 py-2 hover:bg-gray-100" target="_blank">
        Posts
        <svg class="float-right ml-2" xmlns="http://www.w3.org/2000/svg" width="12px" height="12px" viewBox="0 0 16 16"
          fill="none">
          <path d="M7 13V10H0L1.74846e-07 6L7 6L7 3L8 3L13 8L8 13H7Z" fill="#000000" />
          <path d="M14 14V2L16 2V14H14Z" fill="#000000" />
        </svg>
      </button>
    </div>
</body>

</html>