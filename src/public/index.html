<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Document</title>
  <link rel="stylesheet" href="styles.css" />
  <script defer="defer" src="alpinejs.min.js"></script>
  <script src="scripts.js"></script>
  <style>
    .notification {
      position: fixed;
      bottom: 10px;
      right: 10px;
      padding: 15px;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      color: #fff;
    }

    .notification.info {
      background-color: #2196f3;
    }

    .notification.success {
      background-color: #4caf50;
    }

    .notification.warning {
      background-color: #ff9800;
    }

    .notification.error {
      background-color: #f44336;
    }
  </style>
</head>

<body class="flex justify-center items-center">
  <div x-data="initSankakuTools()" x-init="init()"
    class="flex flex-col justify-center items-center bg-white shadow-lg border rounded-lg w-full">
    <div class="z-50 fixed inset-0 flex justify-center items-center bg-gray-800 bg-opacity-50 w-full h-full"
      x-show="isLoading" x-cloak x-transition:enter="ease-out duration-200" x-transition:enter-start="opacity-0"
      x-transition:enter-end="opacity-100" x-transition:leave="ease-in duration-200"
      x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
      <svg class="w-16 h-16 text-green-800 animate-spin" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
        <circle class="opacity-25" cx="25" cy="25" r="20" stroke="currentColor" stroke-width="4" fill="none"></circle>
        <path class="opacity-75" fill="currentColor" d="M25 5A20 20 0 0 1 45 25h-5a15 15 0 0 0-15-15V5z"></path>
      </svg>
    </div>
    <template x-if="!token.hasToken">
      <form @submit.prevent="getToken" class="max-w-screen-lg">
        <h2 class="mb-4 font-bold text-2xl text-center text-red">Missing tokens, login first</h2>
        <div class="mb-4">
          <label class="block mb-2 font-bold text-gray-700" for="username">Username</label>
          <input type="text" id="username" name="login" required x-model="loginData.login"
            placeholder="Enter your username"
            class="px-4 py-2 border rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-indigo-500" />
        </div>
        <div class="mb-4">
          <label class="block mb-2 font-bold text-gray-700" for="password">Password</label>
          <input type="password" id="password" name="password" required x-model="loginData.password"
            placeholder="Enter your password"
            class="px-4 py-2 border rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-indigo-500" />
        </div>
        <div class="flex justify-center">
          <button type="submit"
            class="bg-blue-500 hover:bg-blue-700 px-4 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 font-bold text-white focus:outline-none">
            Login
          </button>
        </div>
      </form>
    </template>
    <template x-if="token.hasToken">
      <div class="gap-4 grid grid-cols-2 w-full">
        <div class="hidden col-span-2 w-full">
          <div class="my-2"><strong>Token Type: </strong><span x-text="token.type"></span></div>
          <div class="my-2">
            <strong>Token:</strong>
            <button @click="copyToken"
              class="bg-green-100 hover:bg-green-300 mx-2 px-2.5 py-0.5 rounded font-semibold text-green-800 text-sm">
              Copy
            </button>
            <small x-ref="token" x-show="false" x-text="token.access_token" class="break-words"></small><span>expire at
              <span x-text="token.expiry_date"></span></span>
          </div>
          <div class="my-2">
            <strong>Refresh Token:</strong>
            <button @click="copyRefreshToken"
              class="bg-green-100 hover:bg-green-300 px-2.5 py-0.5 rounded font-semibold text-green-800 text-sm me-2">
              Copy
            </button>
            <small x-ref="refreshToken" x-show="false" x-text="token.refresh_token"
              class="break-words"></small><span>expire
              at <span x-text="token.refresh_expiry_date"></span></span>
          </div>
        </div>

        <div class="p-4 w-full">
          <form @submit.prevent="processFile" class="mt-4">
            <div class="mb-4">
              <label class="block mb-2 font-bold text-gray-700" for="file">Select a file</label>
              <input type="file" id="file" @change="handleFileUpload"
                class="px-4 py-2 border rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>
            <div class="flex justify-center gap-4">
              <button type="submit"
                class="bg-green-500 hover:bg-green-700 px-4 py-2 rounded-lg focus:ring-2 focus:ring-green-500 font-bold text-white focus:outline-none">
                Process File
              </button>
              <button type="button" @click="downloadTagsJson()"
                class="bg-blue-500 hover:bg-blue-700 px-4 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 font-bold text-white focus:outline-none">
                JSON Content
              </button>
              <button type="button" @click="directDownloadTagsJson()"
                class="bg-blue-500 hover:bg-blue-700 px-4 py-2 rounded-lg focus:ring-2 focus:ring-blue-500 font-bold text-white focus:outline-none">
                Direct Download JSON
              </button>
            </div>
          </form>
          <template x-if="tags.length > 0">
            <div class="my-8">
              <div class="flex md:flex-row flex-col md:items-center md:space-x-4 mb-4">
                <div class="flex flex-col mb-4 md:mb-0">
                  <label for="followFilter" class="font-semibold">Following Status:</label>
                  <select @change="filterTags()" id="followFilter" x-model="selectedFollowFilter"
                    class="border-gray-300 focus:border-indigo-500 focus:ring-opacity-50 shadow-sm mt-1 rounded focus:ring focus:ring-indigo-200">
                    <option value="all">All</option>
                    <option value="1">Following</option>
                    <option value="0">Error / Not Following</option>
                  </select>
                </div>
                <div class="flex flex-col">
                  <label for="statusFilter" class="font-semibold">Fetch Status:</label>
                  <select @change="filterTags()" id="statusFilter" x-model="selectedFetchFilter"
                    class="border-gray-300 focus:border-indigo-500 focus:ring-opacity-50 shadow-sm mt-1 rounded focus:ring focus:ring-indigo-200">
                    <option value="all">All</option>
                    <option value="1">Fetched</option>
                    <option value="0">Error / Unfetched</option>
                  </select>
                </div>
                <div class="relative flex flex-col">
                  <label for="searchTag" class="font-semibold">Search:</label>
                  <input type="text" id="searchTag" class="mr-2 p-1 border rounded text-sm"
                    @input.debounce="searchTagSuggestionsFetched = false; console.log('changed')"
                    @input.debounce.1000="getTagSearchSuggestions($el)"
                    @focus.debounce.500="getTagSearchSuggestions($el)">
                </div>
              </div>
              <div id="fileData" class="mt-4" style="max-height: 620px; overflow-y: scroll; border: 1px solid #000;">
                <table class="table-fixed border-gray-300 border divide-y divide-gray-200 min-w-full">
                  <thead>
                    <tr class="font-semibold text-center text-gray-500 text-sm uppercase tracking-wider">
                      <th class="top-0 sticky bg-gray-200 px-4 py-2 w-24">No.</th>
                      <th class="top-0 sticky bg-gray-200 px-4 py-2 w-36">ID</th>
                      <th class="top-0 sticky bg-gray-200 px-4 py-2">
                        <span @click="sortTags('name')" class="cursor-pointer">
                          Name
                          <span x-show="sortBy === 'name'">
                            <template x-if="sortDesc"><span>▼</span></template>
                            <template x-if="!sortDesc"><span>▲</span></template>
                          </span>
                        </span>
                      </th>
                      <th class="top-0 sticky bg-gray-200 px-4 py-2 w-48">
                        <span @click="sortTags('following')" class="block text-center cursor-pointer">
                          Following
                          <span x-show="sortBy === 'following'">
                            <template x-if="sortDesc"><span>▼</span></template>
                            <template x-if="!sortDesc"><span>▲</span></template>
                          </span>
                        </span>
                        <div class="flex justify-center gap-2">
                          <button @click="fetchFollowingTags()"
                            class="bg-blue-500 hover:bg-blue-700 px-2 py-1 rounded text-white text-xs">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12"
                              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round">
                              <polyline points="1 4 1 10 7 10" />
                              <polyline points="23 20 23 14 17 14" />
                              <path d="M20.49 9A9 9 0 0 0 6.6 5.2L1 10" />
                              <path d="M3.51 15A9 9 0 0 0 17.4 18.8L23 14" />
                            </svg>
                          </button>
                          <button @click="unFollowSelectedTags()"
                            class="bg-red-500 hover:bg-red-700 px-2 py-1 rounded text-white text-xs">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12"
                              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round">
                              <line x1="18" y1="6" x2="6" y2="18" />
                              <line x1="6" y1="6" x2="18" y2="18" />
                            </svg>
                          </button>
                          <button @click="followSelectedTags()"
                            class="bg-green-500 hover:bg-green-700 px-2 py-1 rounded text-white text-xs">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12"
                              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round">
                              <polyline points="20 6 9 17 4 12" />
                            </svg>
                          </button>
                        </div>
                      </th>
                      <th class="top-0 sticky bg-gray-200 px-4 py-2 w-16">
                        <button @click="selectAll()" class="flex justify-center items-center w-full">
                          <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="30px" viewBox="0 0 24 30"
                            fill="none" x="0px" y="0px">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                              d="M4 1C2.34315 1 1 2.34315 1 4V20C1 21.6569 2.34315 23 4 23H20C21.6569 23 23 21.6569 23 20V4C23 2.34315 21.6569 1 20 1H4ZM3 4C3 3.44772 3 3 4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4Z"
                              fill="black" />
                            <path x-show="selectedAll"
                              d="M18.7071 8.70711C19.0976 8.31658 19.0976 7.68342 18.7071 7.29289C18.3166 6.90237 17.6834 6.90237 17.2929 7.29289L10 14.5858L6.70711 11.2929C6.31658 10.9024 5.68342 10.9024 5.29289 11.2929C4.90237 11.6834 4.90237 12.3166 5.29289 12.7071L9.29289 16.7071C9.68342 17.0976 10.3166 17.0976 10.7071 16.7071L18.7071 8.70711Z"
                              fill="black" />
                          </svg>
                        </button>
                      </th>
                    </tr>
                  </thead>
                  <tbody class="bg-white divide-y divide-gray-200">
                    <template x-for="(tag, index) in filteredTags" :key="index">
                      <tr :class="index % 2 === 1 ? 'bg-gray-50' : ''">
                        <td class="px-4 py-2 text-center text-gray-900 text-sm" x-text="index + 1"
                          :class="tag.fetched === true ? 'text-green-700' : (tag.fetched === null ? 'text-red-700' : '')">
                        </td>
                        <td class="px-4 py-2 text-center text-gray-900 text-sm" x-text="tag.id ?? 'null'"
                          :class="tag.fetched === true ? 'text-green-700' : (tag.fetched === null ? 'text-red-700' : '')">
                        </td>
                        <td class="px-4 py-2 text-gray-900 text-sm overflow-visible group" @mouseleave="hideTagsUrl()">
                          <div class="relative flex justify-between items-center">
                            <div class="flex items-center grow">
                              <svg
                                class="group-hover:visible opacity-80 hover:opacity-100 mr-4 cursor-pointer invisible"
                                @click="removeTag(tag)" xmlns="http://www.w3.org/2000/svg" width="20px" height="20px"
                                viewBox="0 0 1024 1024">
                                <path
                                  d="M779.5 1002.7h-535c-64.3 0-116.5-52.3-116.5-116.5V170.7h768v715.5c0 64.2-52.3 116.5-116.5 116.5zM213.3 256v630.1c0 17.2 14 31.2 31.2 31.2h534.9c17.2 0 31.2-14 31.2-31.2V256H213.3z"
                                  fill="#f51818" />
                                <path
                                  d="M917.3 256H106.7C83.1 256 64 236.9 64 213.3s19.1-42.7 42.7-42.7h810.7c23.6 0 42.7 19.1 42.7 42.7S940.9 256 917.3 256zM618.7 128H405.3c-23.6 0-42.7-19.1-42.7-42.7s19.1-42.7 42.7-42.7h213.3c23.6 0 42.7 19.1 42.7 42.7S642.2 128 618.7 128zM405.3 725.3c-23.6 0-42.7-19.1-42.7-42.7v-256c0-23.6 19.1-42.7 42.7-42.7S448 403 448 426.6v256c0 23.6-19.1 42.7-42.7 42.7zM618.7 725.3c-23.6 0-42.7-19.1-42.7-42.7v-256c0-23.6 19.1-42.7 42.7-42.7s42.7 19.1 42.7 42.7v256c-0.1 23.6-19.2 42.7-42.7 42.7z"
                                  fill="#5F6379" />
                              </svg>
                              <!-- Display the tag as a link if fetched is true and not in edit mode -->
                              <a x-show="!tag.isEditing && tag.fetched === true" :title="tag.tagName"
                                :href="getTagPostsUrl(tag)" target="_blank" class="mr-2 text-blue-600 hover:underline"
                                x-text="tag.tagName"></a>
                              <!-- Display the tag name as plain text if fetched is false and not in edit mode -->
                              <span x-show="!tag.isEditing && tag.fetched !== true" :title="tag.tagName"
                                x-text="tag.tagName" class="mr-2"></span>

                              <!-- Input field for editing the tag name, shown regardless of fetched status when in edit mode-->
                              <input type="text" class="mr-2 p-1 border rounded text-sm" x-show="tag.isEditing"
                                x-model="tag.tagName" @keydown.enter="tag.isEditing = false"
                                @click.away="delete tag.isEditing"
                                @input.debounce="searchTagSuggestionsFetched = false; console.log('changed')"
                                @input.debounce.1000="getTagSearchSuggestions($el)"
                                @focus.debounce.500="getTagSearchSuggestions($el)">

                              <!-- Toggle edit mode-->
                              <button class="group-hover:visible opacity-80 hover:opacity-100 ml-1 invisible">
                                <!--Edit icon-->
                                <svg x-show="!tag.isEditing" @click="tag.isEditing = true" width="18px" height="18px"
                                  class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
                                  <title x-text="`Edit tag name`"></title>
                                  <path fill="#3688FF"
                                    d="M823 939H229c-71 0-129-58-129-130V215c0-71 58-130 129-130h297a43 43 0 1 1 0 86H229c-24 0-44 20-44 44v594c0 25 20 44 44 44h594c25 0 45-20 45-44V512a43 43 0 1 1 85 0v297c0 72-58 130-130 130z" />
                                  <path fill="#5F6379"
                                    d="m483 757-5-1-135-17c-19-2-34-17-37-37l-17-134c-1-13 3-26 13-36l374-374c51-51 134-51 186 0l26 26c25 25 38 58 38 93s-13 68-38 93L513 744c-8 8-19 13-30 13zm-96-98 80 10 360-360a45 45 0 0 0 0-65l-26-26a46 46 0 0 0-65 0L377 578l10 81z" />
                                </svg>

                                <!--Confirm icon-->
                                <svg x-show="tag.isEditing" @click="delete tag.isEditing" width="18px" height="18px"
                                  fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                  xmlns="http://www.w3.org/2000/svg">
                                  <title x-text="`Tag name has changed`"></title>
                                  <path id="Vector" d="M6 12L10.2426 16.2426L18.727 7.75732" stroke="#000000"
                                    stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                              </button>
                            </div>
                            <div x-show="tag.fetched" class="flex items-center gap-2">
                              <span class="text-gray-500 italic" x-text="formatPostCount(tag.post_count)"></span>
                              <button @mouseover="showTagsUrl(tag, $el)">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24"
                                  fill="none">
                                  <path id="Vector"
                                    d="M10.0002 5H8.2002C7.08009 5 6.51962 5 6.0918 5.21799C5.71547 5.40973 5.40973 5.71547 5.21799 6.0918C5 6.51962 5 7.08009 5 8.2002V15.8002C5 16.9203 5 17.4801 5.21799 17.9079C5.40973 18.2842 5.71547 18.5905 6.0918 18.7822C6.5192 19 7.07899 19 8.19691 19H15.8031C16.921 19 17.48 19 17.9074 18.7822C18.2837 18.5905 18.5905 18.2839 18.7822 17.9076C19 17.4802 19 16.921 19 15.8031V14M20 9V4M20 4H15M20 4L13 11"
                                    stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                              </button>
                            </div>
                          </div>
                        </td>
                        <td class="px-4 py-2 text-center text-gray-900 text-sm">
                          <template x-if="tag.fetched !== true">
                            <button disabled="disabled" class="bg-gray-500 px-4 py-1 rounded text-white">-
                            </button>
                          </template>
                          <template x-if="tag.fetched === true && tag.following === false">
                            <button @click="followTag(tag)"
                              class="bg-green-500 hover:bg-green-700 px-4 py-1 rounded text-white">
                              Follow
                            </button>
                          </template>
                          <template x-if="tag.fetched === true && tag.following === true">
                            <button @click="unfollowTag(tag)"
                              class="bg-red-500 hover:bg-red-700 px-4 py-1 rounded text-white">
                              Unfollow
                            </button>
                          </template>
                        </td>
                        <td class="px-4 py-2 text-center text-gray-900 text-sm">
                          <button @click="selectTag(tag)" class="flex justify-center items-center w-full"
                            :disabled="tag.fetched !== true">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="30px" viewBox="0 0 24 30"
                              fill="none" x="0px" y="0px">
                              <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M4 1C2.34315 1 1 2.34315 1 4V20C1 21.6569 2.34315 23 4 23H20C21.6569 23 23 21.6569 23 20V4C23 2.34315 21.6569 1 20 1H4ZM3 4C3 3.44772 3 3 4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4Z"
                                fill="black" />
                              <path x-show="tag.selected"
                                d="M18.7071 8.70711C19.0976 8.31658 19.0976 7.68342 18.7071 7.29289C18.3166 6.90237 17.6834 6.90237 17.2929 7.29289L10 14.5858L6.70711 11.2929C6.31658 10.9024 5.68342 10.9024 5.29289 11.2929C4.90237 11.6834 4.90237 12.3166 5.29289 12.7071L9.29289 16.7071C9.68342 17.0976 10.3166 17.0976 10.7071 16.7071L18.7071 8.70711Z"
                                fill="black" />
                            </svg>
                          </button>
                        </td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
            </div>
          </template>
          <template x-if="tags.length === 0">
            <p>No file data available</p>
          </template>
          <template x-if="recentlyUnfollowedTags.length > 0">
            <div class="mt-8">
              <div class="flex items-center gap-4 my-4">
                <span class="font-bold">Recently Unfollowed Tags</span>
                <button type="button"
                  @click="if(confirm('Are you sure?')) {recentlyUnfollowedTags = []; updateLocalStorageForTags()}"
                  class="bg-blue-500 hover:bg-blue-700 px-2 py-1 rounded-lg focus:ring-2 focus:ring-blue-500 font-bold text-white focus:outline-none">
                  Clear
                </button>
              </div>
              <table class="table-fixed border-collapse border-gray-400 border w-full">
                <thead>
                  <tr class="bg-gray-200">
                    <th class="-top-px sticky border-gray-400 bg-gray-200 px-4 py-2 border">No.</th>
                    <th class="-top-px sticky border-gray-400 bg-gray-200 px-4 py-2 border">ID</th>
                    <th class="-top-px sticky border-gray-400 bg-gray-200 px-4 py-2 border w-3/4">
                      <span @click="sortTags('name')" class="block cursor-pointer">
                        Name
                        <span x-show="sortBy === 'name'">
                          <template x-if="sortDesc"><span>▼</span></template>
                          <template x-if="!sortDesc"><span>▲</span></template>
                        </span>
                      </span>
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <template x-for="(tag, index) in recentlyUnfollowedTags" :key="index">
                    <tr>
                      <td class="border-gray-400 px-4 py-2 border text-center" x-text="index + 1"
                        :class="tag.fetched === true ? 'text-green-700' : (tag.fetched === null ? 'text-red-700' : '')">
                      </td>
                      <td class="border-gray-400 px-4 py-2 border text-center" x-text="tag.id ?? 'null'"
                        :class="(tag.fetched === true ? 'text-green-700' : (tag.fetched === null ? 'text-red-700' : ''))">
                      </td>
                      <td :title="tag.tagName" class="border-gray-400 px-4 py-2 border truncate">
                        <template x-if="tag.fetched === true"><a :href="getTagPostsUrl(tag)" target="_blank"
                            class="text-blue-600 hover:underline" x-text="tag.tagName"></a></template>
                        <template x-if="tag.fetched !== true"><span x-text="tag.tagName"></span></template>
                      </td>
                    </tr>
                  </template>
                </tbody>
              </table>
            </div>
          </template>
        </div>

        <!-- Section to show posts for selected tag -->
        <div class="relative p-4 w-full max-h-screen overflow-y-scroll">
          <div>
            <h2 class="mb-4 font-bold text-lg">Posts for: <span x-text="selectedTagToShowPosts.tagName"></span></h2>
            <p class="text-right text-gray-500 text-sm">Total posts fetched: <span
                x-text="selectedTagToShowPosts.fetchedPosts.length"></span></p>
          </div>

          <!-- Loader -->
          <div class="z-50 absolute inset-0 flex justify-center items-center bg-gray-800 bg-opacity-50 w-full h-full"
            x-show="isFetchingPosts" x-cloak x-transition:enter="ease-out duration-200"
            x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
            x-transition:leave="ease-in duration-200" x-transition:leave-start="opacity-100"
            x-transition:leave-end="opacity-0">
            <svg class="w-16 h-16 text-green-800 animate-spin" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
              <circle class="opacity-25" cx="25" cy="25" r="20" stroke="currentColor" stroke-width="4" fill="none">
              </circle>
              <path class="opacity-75" fill="currentColor" d="M25 5A20 20 0 0 1 45 25h-5a15 15 0 0 0-15-15V5z"></path>
            </svg>
          </div>

          <!-- x-show="isShowingPosts" x-cloak -->
          <div>
            <!-- Posts Per Page Selection -->
            <div class="mb-4">
              <label for="postsPerPage" class="mr-2">Posts per page:</label>
              <select id="postsPerPage" x-model="postsPerPage" @change="updateTotalPages"
                class="px-2 py-1 border rounded">
                <option value="10">10</option>
                <option value="20" selected>20</option>
                <option value="50">50</option>
                <option value="100">100</option>
              </select>
            </div>

            <!-- Masonry layout for posts -->
            <div class="sm:columns-1 md:columns-2 lg:columns-3 gap-4">
              <template x-for="(post, index) in paginatedPosts" :key="post.id">
                <!-- Scale container (applies to both image and overlay) -->
                <div
                  class="relative shadow-lg mb-4 rounded transform transition-transform duration-300 overflow-hidden ease-in-out group hover:scale-105">

                  <!-- Image -->
                  <img class="rounded w-full h-auto object-cover" :src="post.preview_url" alt="Post Preview"
                    loading="lazy" />

                  <!-- Button to toggle post information -->
                  <button @click="post.showInfo = !post.showInfo"
                    class="top-2 right-2 absolute bg-gray-800 opacity-0 group-hover:opacity-100 shadow-lg px-2 py-1 rounded text-white text-xs transition-opacity duration-300"
                    aria-label="Show post info">
                    Info
                  </button>

                  <!-- Post information overlay with toggle -->
                  <div x-show="post.showInfo" x-transition:enter="transition ease-out duration-500"
                    x-transition:enter-start="opacity-0 transform translate-y-4"
                    x-transition:enter-end="opacity-100 transform translate-y-0"
                    x-transition:leave="transition ease-in duration-500"
                    x-transition:leave-start="opacity-100 transform translate-y-0"
                    x-transition:leave-end="opacity-0 transform translate-y-4"
                    class="right-0 bottom-0 left-0 absolute bg-black bg-opacity-60 p-2 rounded-b text-white text-xs transition-all duration-500 ease-in-out">
                    <p x-text="'Type: ' + post.file_type"></p>
                    <p x-text="'Rating: ' + post.rating"></p>
                    <p x-text="'Size: ' + formatFileSize(post.file_size)"></p>
                    <p x-text="'Dimensions: ' + post.width + ' x ' + post.height"></p>
                  </div>
                </div>
              </template>
            </div>

            <!-- Pagination Controls -->
            <div class="inline-flex -bottom-4 sticky items-center -space-x-px -mx-4 mt-4 h-10 text-base">
              <!-- Previous Button -->
              <button @click="prevPage" :disabled="currentPage === 1"
                :class="currentPage !== 1 ? 'bg-gray-800 hover:bg-gray-700 hover:border-gray-700 hover:text-white' :'bg-gray-700'"
                class="flex justify-center items-center border-gray-800 px-4 border rounded-s-lg h-10 text-gray-400 leading-tight">
                <span class="sr-only">Previous</span>
                <svg class="w-3 h-3 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                  viewBox="0 0 6 10">
                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M5 1 1 5l4 4" />
                </svg>
              </button>

              <!-- Editable Current Page -->
              <span
                class="flex justify-center items-center border-2 border-gray-700 bg-gray-800 px-3 h-10 text-gray-400 leading-tight">
                Page&nbsp;
                <!-- Editable input for current page -->
                <input type="number" min="1" :max="totalPages" :value="currentPage" @input.debounce.750="jumpToPage($el)"
                  @blur="validatePage($el)" class="bg-transparent py-2.5 border-none w-10 text-center text-gray-200 outline-none" />
                &nbsp;of&nbsp;
                <span x-text="totalPages"></span>
              </span>

              <!-- Next Button -->
              <button @click="nextPage" :disabled="currentPage === totalPages"
                :class="currentPage !== totalPages ? 'bg-gray-800 hover:bg-gray-700 hover:border-gray-700 hover:text-white' :'bg-gray-700'"
                class="flex justify-center items-center border-gray-800 px-4 border rounded-e-lg h-10 text-gray-400 leading-tight">
                <span class="sr-only">Next</span>
                <svg class="w-3 h-3 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                  viewBox="0 0 6 10">
                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="m1 9 4-4-4-4" />
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </template>

    <!-- Global suggestions container (only one for all rows) -->
    <div x-ref="suggestionsContainer"
      class="z-50 absolute border-gray-300 hidden bg-white shadow-sm mt-2 border rounded"
      @click.away="hideSuggestions()">
      <template x-if="searchTagSuggestions.length > 0">
        <ul>
          <template x-for="suggestion in searchTagSuggestions" :key="suggestion.id">
            <li class="flex justify-between gap-8 hover:bg-gray-100 px-4 py-2 cursor-pointer"
              @click="applySuggestion(suggestion)">
              <span x-text="suggestion.name"></span>
              <div class="inline-flex justify-between items-center gap-2">
                <span class="text-gray-500 text-xs" x-text="suggestion.rating ? suggestion.rating : ''"></span>
                <span class="text-gray-500 text-xs" x-text="formatPostCount(suggestion.post_count)"></span>
              </div>
            </li>
          </template>
        </ul>
      </template>
      <template x-if="searchTagSuggestions.length === 0">
        <p>
          No suggestions found
        </p>
      </template>
    </div>

    <!-- Global tag urls container -->
    <div x-ref="tagUrlsContainer" @mouseleave="hideTagsUrl()"
      class="z-50 absolute border-gray-300 hidden grid grid-cols-2 bg-white shadow-sm mt-2 border rounded divide-x">
      <a x-ref="tagWikiUrlEl" href="" class="relative flex justify-between items-center hover:bg-gray-100 px-4 py-2"
        target="_blank">
        Wiki
        <svg class="float-right ml-2" xmlns="http://www.w3.org/2000/svg" width="12px" height="12px" viewBox="0 0 16 16"
          fill="none">
          <path d="M7 13V10H0L1.74846e-07 6L7 6L7 3L8 3L13 8L8 13H7Z" fill="#000000" />
          <path d="M14 14V2L16 2V14H14Z" fill="#000000" />
        </svg>
      </a>
      <button @click="fetchAllPostsOfTag(currentTag)" x-ref="tagPostsUrlEl" href=""
        class="relative flex justify-between items-center hover:bg-gray-100 px-4 py-2" target="_blank">
        Posts
        <svg class="float-right ml-2" xmlns="http://www.w3.org/2000/svg" width="12px" height="12px" viewBox="0 0 16 16"
          fill="none">
          <path d="M7 13V10H0L1.74846e-07 6L7 6L7 3L8 3L13 8L8 13H7Z" fill="#000000" />
          <path d="M14 14V2L16 2V14H14Z" fill="#000000" />
        </svg>
      </button>
    </div>
</body>

</html>